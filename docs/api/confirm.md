# Оплата полиса

## 1. Оплата, деньги принимает партнер.

`POST /sales/v2/{product}/policies/{policy_nr}/confirm`

Вызывая данный метод, партнер подтверждает, что деньги в счет оплаты данного страхового полиса получены.
Полис оплачен.

Тело запроса содержит следующие параметры:

- drafId - id договора, возвращается в ответе при создании страхового полиса в системе.
- amount - сумма к оплате. Должна совпадать с премией по договору.

Коды ответа метода

|Код|Описание|
|-----|----|
|200| Все проверки пройдены. Полис переведен в статус "Оплачено"|
|400| Bad Request. Запрос содержит ошибки.|        
|401| Unauthorized. Партнер не может получить ссылку на оплату для данного договора.| 
|503| Service Unavailable. Сервис оплаты онлайн временно недоступен.|

Пример запроса
~~~
{
  "draftId": "12345-23456-34567",
  "premium": 2000.12
}
~~~

Пример положительного ответа
~~~
{
  "draftId": "12345-23456-34567",
  "premium": 2000.12
}
~~~

## 2. Оплата картой онлайн.

`POST /sales/v2/{product}/policies/{policy_nr}/paymentLink`

Метод формирует страницу для оплаты полиса онлайн, картой.
После получения ссылки, и оплаты полиса, страхователь получает договори другие документы по эл. почте.

Тело запроса содержит следующие параметры:

- drafId - id договора, возвращается в ответе при создании страхового полиса в системе.
- amount - сумма к оплате. Должна совпадать с премией по договору.
- successUrl - страница для перехода после успешной оплаты.     
- failUrl - страница для перехода после неуспешной оплаты.

В случае успешного создания страницы для онлайн оплаты страхового полиса, в ответе вернется параметр - paymentUrl.
Ссылка на страницу оплаты.

Коды ответа метода

|Код|Описание|
|-----|----|
|200| Ответ содержит ссылку на страницу оплаты|
|400| Bad Request. Запрос содержит ошибки.|        
|401| Unauthorized. Партнер не может получить ссылку на оплату для данного договора.| 
|503| Service Unavailable. Сервис оплаты онлайн временно недоступен.|

Пример запроса
~~~
{
  "draftId": "12345-23456-34567",
  "premium": 2000.12,
  "successUrl": "www.success.url",
  "failUrl": "www.fail.url"
}
~~~

Пример положительного ответа
~~~
{
  "draftId": "12345-23456-34567",
  "premium": 2000.12,
  "successUrl": "www.success.url",
  "failUrl": "www.fail.url"
  "paymentUrl": "www.somebank.com/payment/page"
}
~~~
  
Пример ответа с ошибкой
~~~
{
  "errorCode": "ERR-00105",
  "errorDescription": "сервер недоступен"
}
~~~
 